let t = #a|#b|#c|#d

def main(x) {
    #a
    #b
    repeat x {
        #c
        #d
    }
    #a
}

test @both(t) { #a ; #b ; #a } main(#0);
test fail @up(t) { #a ; #b ; #a } main(#1);
test @both(t) { #a ; #b ; #c ; #d ; #a } main(#1);
test @both(t) { #a ; #b ; #c ; #d ; #c ; #d ; #a } main(#2);
test fail @up(t) { #a ; #b ; #c ; #a } main(_);
test fail @up(t) { #a ; #b ; #c ; #d } main(_);
